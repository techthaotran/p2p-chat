{"ast":null,"code":"import _slicedToArray from \"D:\\\\FW\\\\p2p-chat\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\FW\\\\p2p-chat\\\\src\\\\JoinDialog.js\";\nimport React, { useEffect, useState } from \"react\";\nimport SimplePeer from \"simple-peer\";\nimport { Dialog } from \"use-dialog\";\nexport function JoinDialog(_ref) {\n  var onConnect = _ref.onConnect;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      peer = _useState4[0],\n      setPeer = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      offer = _useState6[0],\n      setOffer = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      answer = _useState8[0],\n      setAnswer = _useState8[1];\n\n  useEffect(function () {\n    var p = new SimplePeer({\n      initiator: false,\n      trickle: false,\n      objectMode: true\n    });\n    p.on(\"signal\", function (data) {\n      setAnswer(data);\n    });\n    p.on(\"connect\", function () {\n      onConnect(p);\n    });\n    setPeer(p);\n  }, [onConnect]);\n  useEffect(function () {\n    if (peer && offer) {\n      var offerObject;\n\n      try {\n        offerObject = JSON.parse(offer);\n        peer.signal(offerObject);\n      } catch (err) {\n        console.warn(\"invalid offer\");\n      }\n    }\n  }, [offer, peer]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Dialog, {\n    state: [open, setOpen],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 9\n    }\n  }, \"Join Room\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }\n  }, \"Paste an offer from a peer below, send them your answer, then wait for them to connect.\"), /*#__PURE__*/React.createElement(\"form\", {\n    method: \"dialog\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 13\n    }\n  }, \"Offer\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    style: {\n      width: \"100%\"\n    },\n    rows: \"6\",\n    value: offer,\n    onChange: function onChange(evt) {\n      setOffer(evt.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }\n  }, \"Answer\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    style: {\n      width: \"100%\"\n    },\n    readOnly: true,\n    rows: \"6\",\n    value: JSON.stringify(answer),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  }, \"Cancel\"))), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      return setOpen(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }, \"Join Room\"));\n}","map":{"version":3,"names":["React","useEffect","useState","SimplePeer","Dialog","JoinDialog","onConnect","open","setOpen","peer","setPeer","offer","setOffer","answer","setAnswer","p","initiator","trickle","objectMode","on","data","offerObject","JSON","parse","signal","err","console","warn","width","evt","target","value","stringify"],"sources":["D:/FW/p2p-chat/src/JoinDialog.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport SimplePeer from \"simple-peer\";\r\nimport { Dialog } from \"use-dialog\";\r\n\r\nexport function JoinDialog({ onConnect }) {\r\n  const [open, setOpen] = useState(false);\r\n  const [peer, setPeer] = useState(null);\r\n  const [offer, setOffer] = useState(\"\");\r\n  const [answer, setAnswer] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const p = new SimplePeer({\r\n      initiator: false,\r\n      trickle: false,\r\n      objectMode: true\r\n    });\r\n    p.on(\"signal\", data => {\r\n      setAnswer(data);\r\n    });\r\n    p.on(\"connect\", () => {\r\n      onConnect(p);\r\n    });\r\n\r\n    setPeer(p);\r\n  }, [onConnect]);\r\n\r\n  useEffect(() => {\r\n    if (peer && offer) {\r\n      let offerObject;\r\n      try {\r\n        offerObject = JSON.parse(offer);\r\n        peer.signal(offerObject);\r\n      } catch (err) {\r\n        console.warn(\"invalid offer\");\r\n      }\r\n    }\r\n  }, [offer, peer]);\r\n\r\n  return (\r\n    <>\r\n      <Dialog state={[open, setOpen]}>\r\n        <h2>Join Room</h2>\r\n        <p>\r\n          Paste an offer from a peer below, send them your answer, then wait for\r\n          them to connect.\r\n        </p>\r\n        <form method=\"dialog\">\r\n          <label>\r\n            <b>Offer</b>\r\n            <textarea\r\n              style={{ width: \"100%\" }}\r\n              rows=\"6\"\r\n              value={offer}\r\n              onChange={evt => {\r\n                setOffer(evt.target.value);\r\n              }}\r\n            />\r\n          </label>\r\n\r\n          <label>\r\n            <b>Answer</b>\r\n            <textarea\r\n              style={{ width: \"100%\" }}\r\n              readOnly\r\n              rows=\"6\"\r\n              value={JSON.stringify(answer)}\r\n            />\r\n          </label>\r\n\r\n          <button>Cancel</button>\r\n        </form>\r\n      </Dialog>\r\n      <button onClick={() => setOpen(true)}>Join Room</button>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}